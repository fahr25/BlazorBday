@using BlazorBday.Services
@inject CartService CartService

<aside class="cart" aria-label="Shopping cart" id="cart-pane">
    <h4>Cart <span id="cart-count" class="badge">@CartService.Items.Sum(i => i.Quantity)</span></h4>
    <div class="cart-list" role="list">
        @if (CartService.Items.Count == 0)
        {
            <div style="padding:8px;color:#556">Cart is empty</div>
        }
        else
        {
            @foreach (var item in CartService.Items)
            {
                <div class="cart-item">
                    <div class="small-img" aria-hidden="true">ðŸ§º</div>
                    <div style="flex:1">
                        <div style="font-weight:700">@item.ProductName</div>
                        <div style="color:#667">@item.Quantity * @item.UnitPoints pts</div>
                    </div>
                    <div style="text-align:right">
                        <button class="btn ghost" @onclick="() => CartService.Increment(item.ProductId)">+</button>
                        <button class="btn ghost" @onclick="() => CartService.Decrement(item.ProductId)">âˆ’</button>
                    </div>
                </div>
            }
        }
    </div>
    <div class="total-row">
        <div>Total</div>
        <div class="cart-total">@CartService.GetTotal() pts</div>
    </div>
    <p style="margin-top:8px"><button class="btn" @onclick="Checkout">Checkout</button></p>
</aside>

@code {
    protected override void OnInitialized()
    {
        CartService.OnChange += StateHasChanged;
    }

    private void Checkout()
    {
        // Simulate (e.g., alert or navigate to a payment page)
        // TODO: Implement actual checkout logic
        Console.WriteLine("Checkout clicked!");
    }
}