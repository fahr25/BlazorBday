@using BlazorBday.Models
@using System.Text.Json
@{
    var sessionStr = Context.Session.GetString("OrderDraft");
    var draft = string.IsNullOrEmpty(sessionStr) ? new OrderDraft() : JsonSerializer.Deserialize<OrderDraft>(sessionStr);
    var itemCount = draft.Items.Count;
}

<!-- Mobile Bottom Cart Bar - visible only < 768px -->
<div class="mobile-cart-bar d-md-none" id="mobileCartBar">
    <button class="mobile-cart-trigger w-100" type="button" data-bs-toggle="offcanvas" data-bs-target="#cartOffcanvas" aria-controls="cartOffcanvas">
        <div class="d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center gap-2">
                <span class="cart-icon">ðŸ›’</span>
                <span class="cart-count-badge">@itemCount</span>
            </div>
            <div class="cart-points">
                <span class="points-label">Remaining:</span>
                <span class="points-value">@draft.PointsRemaining pts</span>
            </div>
            <span class="expand-icon">â–²</span>
        </div>
    </button>
</div>

<!-- Offcanvas Cart Drawer -->
<div class="offcanvas offcanvas-bottom cart-offcanvas" tabindex="-1" id="cartOffcanvas" aria-labelledby="cartOffcanvasLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="cartOffcanvasLabel">Your Cart</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        @await Html.PartialAsync("_CartSummary")
    </div>
</div>
